<!-- =================== INÍCIO: footer móvel fixo embaixo (aparece só em <1024px) =================== -->
<div class="mobile-footer">
  <div class="summary-info">
    <nb-icon icon="file-text-outline"></nb-icon>
    <span class="ml-1">RESUMO</span>
    <div class="ms-3 d-flex flex-column">
      <div>
        Valor no boleto bancário:
        <strong>R$ {{ valorBoleto | number:'1.2-2' }}</strong>
      </div>
      <div class="small text-muted">
        Método: {{ selectedMethod | uppercase }}
      </div>
    </div>
  </div>
  <button nbButton status="primary" class="btn-continue-mobile" (click)="onContinue()">
    CONTINUAR
  </button>
</div>
<!-- =================== FIM: footer móvel =================== -->

<div class="container-pay">
  <div class="inner">
    <!-- card de pagamento (desktop & mobile) -->
    <nb-card class="payment-card">
      <nb-card-body>
        <h3>Escolha uma das formas de pagamento:</h3>
        <form [formGroup]="paymentForm">
          <nb-accordion >
            <nb-accordion-item
              *ngFor="let m of methods"
              [expanded]="selectedMethod === m.value"
              
            >
              <!-- cabeçalho: clique controlado via CSS/customização -->
              <nb-accordion-item-header  (click)="selectMethod(m.value)" (click)="$event.stopPropagation()">
                <nb-radio
                  [value]="m.value"
                  [checked]="selectedMethod === m.value"
                  (checkedChange)="paymentForm.get('paymentMethod')!.setValue(m.value)"
                >
                  <span class="ml-2">{{ m.label }}</span>
                </nb-radio>

                <nb-icon
                  [icon]="m.icon"
                  class="custom-toggle-icon"
                ></nb-icon>
                <div *ngIf="m.value === 'pix'">
                  <img 
                    src="/images/pix.png" 
                    alt="Pix" 
                    class="pix-logo custom-toggle-icon-2"
                  />
                </div>
              </nb-accordion-item-header>

              <nb-accordion-item-body>
                <div *ngIf="m.value === 'lojas'">
                  <p>Escolha a loja:</p>
                  <a 
                    href="https://shopee.com" 
                    nbButton 
                    target="_blank"
                    rel="noopener noreferrer"
                    status="info"
                  >
                    Shopee
                  </a>
                  <a 
                    href="https://magalu.com" 
                    nbButton
                    target="_blank"
                    rel="noopener noreferrer" 
                    status="warning"
                  >
                    Magalu
                  </a>                    
                </div>
                <div *ngIf="m.value === 'pix'">
                  <p>Copie nossa chave e finalize no seu app bancário.</p>
                </div>
                <div *ngIf="m.value === 'card'">
                  <p>Você será redirecionado ao checkout de cartão.</p>
                </div>
              </nb-accordion-item-body>
            </nb-accordion-item>
          </nb-accordion>
        </form>
        <nb-alert class="mt-2 flex align-items-center" status="info">
          <img
            src="/images/bell.png"
            alt="imagem de um sino"
            class="alert-logo"
          />
          Atenção. Lembre-se de clicar em finalizar para reservar o item!
        </nb-alert>
      </nb-card-body>
    </nb-card>

    <!-- card de resumo (aparece apenas em desktop) -->
    <nb-card class="summary-card">
      <nb-card-body class="d-flex flex-column" style="padding: 1rem;">
        <h4 class="mb-3">Resumo</h4>

        <div class="mb-3">
          <div><strong>Produto:</strong> {{ productValue?.titulo }}</div>
          <div><strong>Descrição:</strong> {{ productValue?.descricao }}</div>
        </div>

        <div class="mb-3" style="font-size: 0.9rem;">
          <div class="d-flex justify-content-between">
            <span>Valor do Médio do Produto:</span>
            <!--
               TODO
                Mudar o valor do produto para number do tipo inteiro, atualmente esta strign
            -->
            <span>R$ {{ valorProdutos | number:'1.2-2' }}</span>
            <span>R$ {{ productValue?.valor }}</span>
          </div>
          <hr />
        </div>

        <div class="flex-grow-1"></div>

        <div class="d-flex justify-content-end gap-2 mt-2">
          <button nbButton status="danger" size="small" (click)="voltarHome()">Voltar</button>
          <button nbButton status="primary" size="small" type="submit" (click)="onContinue()">{{ textoContinuar }}</button>
        </div>
      </nb-card-body>
    </nb-card>
  </div>
</div>
